<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beez Style POS - å“æ¨‚æ•¸ä½</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --beez-blue: #5d87a1; --beez-dark: #343a40; --beez-bg: #e9ecef; }
        body { font-family: sans-serif; background: var(--beez-bg); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* å·¦å´å°èˆªæ¬„ */
        .sidebar { width: 200px; background: var(--beez-dark); color: white; display: flex; flex-direction: column; padding: 10px; }
        .menu-item { padding: 12px; border-bottom: 1px solid #4b545c; cursor: pointer; font-size: 14px; }
        .menu-item:hover { background: #495057; }

        /* ä¸­é–“ç”¢å“å€ */
        .main-panel { flex: 1; display: flex; flex-direction: column; background: white; border-right: 1px solid #ccc; }
        .product-tabs { display: flex; background: white; border-bottom: 1px solid #ddd; }
        .tab { flex: 1; padding: 15px; text-align: center; border-right: 1px solid #ddd; cursor: pointer; font-weight: bold; }
        .tab.active { border-bottom: 3px solid var(--beez-blue); color: var(--beez-blue); }
        .product-grid { flex: 1; padding: 15px; display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; overflow-y: auto; background: #f8f9fa; }
        .prod-card { background: white; border: 1px solid #ddd; border-radius: 5px; padding: 10px; text-align: center; font-size: 13px; }
        .prod-img { width: 60px; height: 60px; background: #eee; border-radius: 50%; margin: 0 auto 10px; }

        /* å³å´çµå¸³æœå°‹å€ */
        .right-panel { width: 380px; background: white; display: flex; flex-direction: column; padding: 15px; }
        .search-box { position: relative; margin-bottom: 15px; }
        input#memberInput { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; }
        
        /* æ¨¡ç³Šæœå°‹æ¨™ç±¤ */
        #fuzzyTags { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #ccc; z-index: 100; display: none; max-height: 200px; overflow-y: auto; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .tag-item { padding: 10px; border-bottom: 1px solid #eee; cursor: pointer; font-weight: bold; color: var(--beez-blue); }

        /* æ­·å²èˆ‡åºè™Ÿè¿½è¹¤ */
        .history-list { flex: 1; overflow-y: auto; margin-bottom: 15px; border: 1px solid #eee; border-radius: 5px; padding: 10px; background: #fffdf2; }
        .history-entry { border-bottom: 1px solid #eee; padding: 8px 0; font-size: 13px; }
        .sn-track { display: block; font-size: 11px; color: #666; background: #f0f0f0; padding: 3px 6px; border-radius: 3px; margin-top: 4px; border-left: 3px solid var(--beez-blue); }

        /* é€²è²¨åŠŸèƒ½å€ (æ•´åˆåœ¨å³ä¸‹æ–¹) */
        .stock-footer { border-top: 2px solid #ddd; padding-top: 10px; }
        .stock-input { width: 100%; padding: 8px; margin-bottom: 5px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; }
        .btn-confirm { width: 100%; padding: 15px; background: #4b7d94; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; }
    </style>
</head>
<body>

<div class="sidebar">
    <div style="font-weight:bold; margin-bottom:20px;">Beez POS</div>
    <div class="menu-item">å®¢æˆ¶ç®¡ç†</div>
    <div class="menu-item">ç”¢å“ç®¡ç†</div>
    <div class="menu-item">åº«å­˜ç®¡ç†</div>
    <div class="menu-item">å ±è¡¨ä¸­å¿ƒ</div>
</div>

<div class="main-panel">
    <div class="product-tabs">
        <div class="tab active">ğŸ“‹ ç”¢å“åˆ—è¡¨</div>
        <div class="tab">ğŸ” æœå°‹ç”¢å“</div>
        <div class="tab">â¤ï¸ å¸¸ç”¨ç”¢å“</div>
    </div>
    <div style="background:black; color:white; padding:10px; font-size:12px; display:flex; gap:15px;">
        <span>3Cé…ä»¶é¡</span><span>å®¶é›»</span><span>æ‰‹æ©Ÿå¹³æ¿</span><span>ç¶­ä¿®é¡</span><span>é›»ä¿¡åˆç´„</span>
    </div>
    <div class="product-grid">
        <div class="prod-card"><div class="prod-img"></div>20Wå£è¢‹é›»æº</div>
        <div class="prod-card"><div class="prod-img"></div>2.5Dé˜²çªºAR</div>
        <div class="prod-card"><div class="prod-img"></div>14 8G+256G</div>
        <div class="prod-card"><div class="prod-img"></div>17 Pro Max</div>
        <div class="prod-card"><div class="prod-img"></div>2.5Dä½è—å…‰ç»ä¿</div>
    </div>
</div>

<div class="right-panel">
    <div class="search-box">
        <input type="text" id="memberInput" placeholder="è«‹æƒæ/è¼¸å…¥æœƒå“¡ç·¨è™Ÿæˆ–å§“å" oninput="doSearch()">
        <div id="fuzzyTags"></div>
    </div>

    <div id="historyDisplay" class="history-list">
        <div style="color:#999; text-align:center; padding-top:20px;">è«‹æœå°‹æœƒå“¡é¡¯ç¤ºæ­·å²èˆ‡åºè™Ÿè¿½è¹¤</div>
    </div>

    <div class="stock-footer">
        <div style="font-weight:bold; font-size:14px; margin-bottom:5px;">ğŸ“¦ é€²è²¨/åºè™Ÿç´€éŒ„</div>
        <select class="stock-input" id="buyType">
            <option value="æ‰‹æ©Ÿ">æ‰‹æ©Ÿé€²è²¨</option>
            <option value="é…ä»¶/å…¶ä»–">é…ä»¶/å…¶ä»–å•†å“é€²è²¨</option>
        </select>
        <input type="text" id="snCode" class="stock-input" placeholder="è¼¸å…¥ IMEI / åºè™Ÿ">
        <input type="text" id="supplier" class="stock-input" placeholder="è¼¸å…¥é€²è²¨äºº / ä¾›æ‡‰å•†">
        <button class="btn-confirm" onclick="alert('è¨˜éŒ„æˆåŠŸï¼')">ç¢ºèªçµå¸³ / é€²è²¨</button>
    </div>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://mypos2026-2625d-default-rtdb.asia-southeast1.firebasedatabase.app/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let members = {};

    db.ref('members').on('value', (s) => { members = s.val() || {}; });

    function doSearch() {
        const val = document.getElementById('memberInput').value.trim();
        const tags = document.getElementById('fuzzyTags');
        tags.innerHTML = '';
        if(!val) { tags.style.display = 'none'; return; }

        const matches = Object.keys(members).filter(n => n.includes(val));
        if(matches.length > 0) {
            tags.style.display = 'block';
            matches.forEach(name => {
                const div = document.createElement('div');
                div.className = 'tag-item';
                div.innerText = name;
                div.onclick = () => { selectMember(name); };
                tags.appendChild(div);
            });
        }
        if(members[val]) selectMember(val);
    }

    function selectMember(name) {
        document.getElementById('memberInput').value = name;
        document.getElementById('fuzzyTags').style.display = 'none';
        const display = document.getElementById('historyDisplay');
        display.innerHTML = `<strong>${name} çš„æ­·å²ç´€éŒ„ï¼š</strong><br>`;
        
        const history = members[name].history;
        Object.values(history).sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(h => {
            display.innerHTML += `
                <div class="history-entry">
                    <span style="color:#888; font-size:11px;">${h.date}</span><br>
                    ${h.item} <span style="color:red; float:right;">$${h.price}</span>
                    ${h.sn ? `<span class="sn-track">åºè™Ÿï¼š${h.sn} | é€²è²¨ï¼š${h.supplier || 'ç¶²è·¯'}</span>` : ''}
                </div>`;
        });
    }
</script>

</body>
</html>
